knitr::opts_chunk$set(echo = FALSE)
# Learn more about creating websites with Distill at:
# https://rstudio.github.io/distill/website.html
# Learn more about publishing to GitHub Pages at:
# https://rstudio.github.io/distill/publish_website.html#github-pages
library(tidyverse)
install.packages("distill")
readr::read_csv("https://github.com/joy-hhh/R_for_JE_test/blob/main/je_utf_colname.txt")
je_raw <- readr::read_csv("https://raw.githubusercontent.com/joy-hhh/R_for_JE_test/main/je_tsv_utf.txt")
je_raw
je_raw <- readr::read_csv("https://raw.githubusercontent.com/joy-hhh/R_for_JE_test/main/je_utf_colname.txt")
je_raw
knitr::opts_chunk$set(echo = FALSE)
je_raw <- readr::read_csv("https://raw.githubusercontent.com/joy-hhh/R_for_JE_test/main/je.csv")
je_raw
je_raw <- readr::read_csv("https://raw.githubusercontent.com/joy-hhh/R_for_JE_test/main/je_utf_minimal.csv")
je_raw
je_tbl <- rename(je_raw, JEDATE = `구 분[기표][년/월/일]`,
JENO = JENO,
amount = amount,
record = Record,
ACCTCD = ACCT_CD,
ACCT_NM = ACCT_NM)
je_tbl <- rename(je_raw, JEDATE = `구 분[기표][년/월/일]`,
JENO = JENO,
amount = amount,
record = Record,
ACCTCD = ACCT_CD,
ACCT_NM = ACCT_NM)
library(tidyverse)
je_tbl <- rename(je_raw, JEDATE = `구 분[기표][년/월/일]`,
JENO = JENO,
amount = amount,
record = Record,
ACCTCD = ACCT_CD,
ACCT_NM = ACCT_NM)
je_tbl
je_tbl %>%
is.na() %>%
colSums()
je_tbl <- je_tbl %>%
mutate(across(amount, \(x) ifelse(is.na(x), 0, x)),
JEDATE = ymd(JEDATE),
month = as_factor(month(JEDATE)),
ACCTCD = as_factor(ACCTCD),
JENO = as.character(JENO)
)
je_tbl
## 차변합계
sum_DR <- je_tbl %>%
filter(record == "차변") %>%
select(amount) %>%
pull() %>%
sum()
## 대변합계
sum_CR <- je_tbl %>%
filter(record == "대변") %>%
select(amount) %>%
pull() %>%
sum()
print("차변합계와 대변합계가 같은지 확인한다.")
print("차변합계와 대변합계가 같은가?")
print(sum_DR == sum_CR)
A02 <- je_tbl %>%
select(JENO, amount, record) %>%
pivot_wider(id_cols = JENO, names_from = record, values_from = amount, values_fn = sum) %>%
mutate(Differ= 차변 - 대변)
A02 <- je_tbl %>%
select(JENO, amount, record) %>%
pivot_wider(id_cols = JENO, names_from = record, values_from = amount, values_fn = sum) %>%
mutate(Differ= S - H)
print(A02)
A02 %>% filter(Differ != 0)
A03 <- je_tbl %>%
select(ACCTCD, amount, record) %>%
pivot_wider(id_cols = ACCTCD, names_from = record, values_from = amount, values_fn = sum) %>%
# join 할때 자료형 일치
mutate(ACCTCD = as.character(ACCTCD))
A03 <- left_join(A03, cytb_move, by = 'ACCTCD')
if(!require(benford.analysis)){install.packages("benford.analysis");library(benford.analysis)}
je_sales <- je_tbl %>%
filter(ACCTCD == '40401')
je_sales$CR %>% benford()
je_raw <- readr::read_csv("https://raw.githubusercontent.com/joy-hhh/R_for_JE_test/main/je.csv")
je_tbl <- rename(je_raw, JEDATE = 전표일자,
JENO = 전표번호,
DR = 차변금액,
CR = 대변금액,
ACCTCD = 계정코드,
ACCT_NM = 계정과목명)
je_tbl <- je_tbl %>%
mutate(across(DR:CR, \(x) ifelse(is.na(x), 0, x)),
JEDATE = ymd(JEDATE),
month = as_factor(month(JEDATE)),
ACCTCD = as_factor(ACCTCD),
JENO = as.character(JENO))
je_tbl
je_sales <- je_tbl %>%
filter(ACCTCD == '40401')
je_sales$CR %>% benford()
bl <- je_sales$CR %>% benford()
plot(bl)
if(!require(devtools)){install.packages("devtools")}
if(!require(rsmsampling)){devtools::install_github("joy-hhh/rsmsampling");library(rsmsampling)}
SR <- "No"          ## or  "Yes"
RC <- "Yes"         ## or  "No"
PL <- 4             ## "Analytical.Procedures.Not.Performed" 4, "High" 1, "Low" 2, "Moderate" 3
am <- "CR"          ## 금액열 지정
## 수행중요성 금액 및 허용오류율(5% 등) 입력
PM <- 700000000     ## Tolerable misstatement (generally performance materiality)
EA <- 0.05          ## Expected misstatement
## Define Population
acc <- c("40100", "40401", "40700", "41100", "41200")  # 총 매출 계정 모음
population <- je_tbl %>%
filter(ACCTCD %in% acc)
## 함수 실행
sampling <- mus_sampling(population, am, SR, RC, PL, PM, EA) # population : 샘플링 대상 모집단
## 샘플링 내역 확인
print(sampling, n = Inf)
## Define Population
acc <- c("40100", "40401", "40700", "41100", "41200")  # 총 매출 계정 모음
co_sampling <- je_tbl %>%
filter(ACCTCD %in% acc) %>%
filter(month == 12) %>%
ran_sampling(30)
## MUS sampling과 중복 항목 제거
co_sampling <- co_sampling %>%
filter(!JENO %in% sampling$JENO)
co_sampling
co_sampling %>% write_xlsx("CO_sample.xlsx")
je_raw <- readr::read_csv("https://raw.githubusercontent.com/joy-hhh/R_for_JE_test/main/je.csv")
je_raw
acc <- c("40100", "40401", "40700", "41100", "41200")
acc
je_raw %>% filter(계정…³ %in% acc)
colnames(je_raw)
je_raw %>% filter(계정코드 %in% acc)
library(tidyverse)
je_raw %>% filter(계정코드 %in% acc)
je_raw %>% filter(계정코드 %in% acc) %>% split(.$계정과목명) -> revenue_gl
revenue_gl
revenue_gl %>% writexl::write_xlsx("revenue_gl.xlsx")
getwd()
je_raw |> filter(계정코드 %in% acc) |> split(.$계정과목명) -> revenue_gl
install.packages("distill")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
install.packages('rlang')
install.packages("rlang")
install.packages("rlang")
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse\)
library(tidyverse)
install.packages("skimr")
